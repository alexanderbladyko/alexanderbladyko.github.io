(this["webpackJsonprhythm-trainer"]=this["webpackJsonprhythm-trainer"]||[]).push([[0],{14:function(e,t,n){e.exports={base:"NumberInput_base__3_jvl",value:"NumberInput_value__2TZQv",button:"NumberInput_button__r1qHB"}},184:function(e,t,n){e.exports=n.p+"static/media/quarter.bb8e6d28.svg"},185:function(e,t,n){e.exports=n.p+"static/media/eights.31053e72.svg"},186:function(e,t,n){e.exports=n.p+"static/media/sixteens.1f967ff7.svg"},187:function(e,t,n){e.exports=n.p+"static/media/triplet.e0d4aa7c.svg"},2:function(e,t,n){e.exports={base:"NotesSequence_base__3dvsm",caption:"NotesSequence_caption__2LHUQ",source:"NotesSequence_source__d5irw",sequence:"NotesSequence_sequence__2xvMW",sequence__over:"NotesSequence_sequence__over__3shs9",item:"NotesSequence_item__2ctfQ",item__dragging:"NotesSequence_item__dragging__11Bwo",item__blink:"NotesSequence_item__blink__JjFl1",blink:"NotesSequence_blink__UjfDb",note:"NotesSequence_note__fO8Sk",note__dragging:"NotesSequence_note__dragging__LV6DQ"}},226:function(e,t,n){"use strict";n.r(t);var a,r,c=n(0),i=n.n(c),s=n(22),o=n.n(s),l=(n(96),i.a.createContext([])),u=n(83),m=n.n(u),d=n(16),v=n.n(d),b=n(13),p=n(5),f=n(84),h=n.n(f),g=n(4),E=n(9),_=n(7),N=n(6),k=n(8),O=n(1),y=n(23),j=n(17),T=n.n(j);!function(e){e[e.Fours=0]="Fours",e[e.Eights=1]="Eights",e[e.Sixteens=2]="Sixteens",e[e.Triplets=3]="Triplets"}(r||(r={}));a={},Object(O.a)(a,r.Fours,[0]),Object(O.a)(a,r.Eights,[0,.5]),Object(O.a)(a,r.Sixteens,[0,.25,.5,.75]),Object(O.a)(a,r.Triplets,[0,1/3,2/3]);var S,C,x=n(2),D=n.n(x);function I(e,t,n){var a=Object(b.a)(e),r=a.splice(t,1),c=Object(p.a)(r,1)[0];return a.splice(n,0,c),a}!function(e){e.NOTES="notes",e.SEQUENCE="sequence"}(C||(C={}));var w,q=(S={},Object(O.a)(S,r.Fours,n(184)),Object(O.a)(S,r.Eights,n(185)),Object(O.a)(S,r.Sixteens,n(186)),Object(O.a)(S,r.Triplets,n(187)),S),R=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(_.a)(this,Object(N.a)(t).call(this,e))).handleDragEnd=function(e){var t=e.source,a=e.destination;if(t.droppableId===C.SEQUENCE){if(!a||a.droppableId!==C.SEQUENCE){var r=Object(b.a)(n.state.sequence);return r.splice(t.index,1),n.setState({sequence:r})}return n.setState({sequence:I(n.state.sequence,t.index,a.index)})}if(t.droppableId===C.NOTES&&(null===a||void 0===a?void 0:a.droppableId)===C.SEQUENCE){var c=Object(b.a)(n.state.sequence);return c.splice(a.index,0,n.state.notes[t.index]),n.setState({sequence:c})}},n.renderNote=function(e,t){return i.a.createElement(y.b,{key:e,draggableId:"note_".concat(e),index:t},(function(t,n){return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",Object.assign({ref:t.innerRef,className:T()(D.a.note,Object(O.a)({},D.a.note__dragging,n.isDragging))},t.draggableProps,t.dragHandleProps),i.a.createElement("img",{alt:"",src:q[e]})),n.isDragging&&i.a.createElement("div",{className:T()(D.a.note)},i.a.createElement("img",{alt:"",src:q[e]})))}))},n.renderSequenceNote=function(e,t){return i.a.createElement(y.b,{key:t,draggableId:"sequence_note_".concat(t),index:t},(function(t,n){var a;return i.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps,t.dragHandleProps,{className:T()(D.a.item,(a={},Object(O.a)(a,D.a.item__draggable,n.isDragging),Object(O.a)(a,D.a.item__dropping,n.isDropAnimating),a)),style:t.draggableProps.style}),i.a.createElement("img",{alt:"",src:q[e]}))}))},n.state={notes:[r.Fours,r.Eights,r.Triplets,r.Sixteens],sequence:e.sequence},n}return Object(k.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this;return this.props.isPlaying?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:D.a.caption},"Sequence (size: 4/4)"),i.a.createElement("div",{className:D.a.sequence},this.state.notes.map((function(t,n){return i.a.createElement("div",{key:n+e.props.playingIndex,className:T()(D.a.item,Object(O.a)({},D.a.item__blink,n===e.props.noteIndex))},i.a.createElement("img",{alt:"",src:q[t]}))}))),i.a.createElement("div",{className:D.a.caption},"Notes"),i.a.createElement("div",{className:D.a.source},this.state.notes.map((function(e,t){return i.a.createElement("div",{className:T()(D.a.note),key:t},i.a.createElement("img",{alt:"",src:q[e]}))})))):i.a.createElement(y.a,{onDragEnd:this.handleDragEnd},i.a.createElement("div",{className:D.a.caption},"Sequence (size: 4/4)"),i.a.createElement(y.c,{droppableId:C.SEQUENCE,direction:"horizontal"},(function(t,n){return i.a.createElement("div",{ref:t.innerRef,className:T()(D.a.sequence,Object(O.a)({},D.a.sequence__over,n.isDraggingOver))},i.a.createElement("div",null,e.state.sequence.map(e.renderSequenceNote),i.a.createElement("div",{style:{display:"none"}},t.placeholder)))})),i.a.createElement("div",{className:D.a.caption},"Notes"),i.a.createElement(y.c,{droppableId:C.NOTES,direction:"horizontal",isDropDisabled:!0},(function(t,n){return i.a.createElement("div",Object.assign({ref:t.innerRef,className:D.a.source},t.droppableProps,{style:{transitionDuration:"0.001s"}}),e.state.notes.map(e.renderNote),i.a.createElement("div",{style:{display:"none"}},t.placeholder))})))}}]),t}(i.a.Component),F=n(89),A=n.n(F),M=function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(_.a)(this,Object(N.a)(t).call(this,e))).canvas=void 0,n.onResize=function(){n.canvas.current&&(n.canvas.current.height=n.canvas.current.parentElement.clientHeight,n.canvas.current.width=n.canvas.current.parentElement.clientWidth,n.draw())},n.draw=function(){if(n.canvas.current){var e=n.canvas.current.getContext("2d"),t=n.canvas.current,a=t.width,r=t.height;if(e){e.clearRect(0,0,a,r);var c=n.props.idealClicks[n.props.from]-.5,i=n.props.idealClicks[n.props.idealClicks.length-1]-c+.5;n.props.idealClicks.forEach((function(t){return n.drawLine(e,a*(t-c)/i,0,r/2,"#4287f5")})),n.props.realClicks.forEach((function(t){return n.drawLine(e,a*(t.actualClick-c)/i,r/2,r,n.getColorByDelta(t.delta))}))}}},n.drawLine=function(e,t,n,a,r){var c=Math.round(t);e.beginPath(),e.strokeStyle=r,e.moveTo(c,n),e.lineTo(c,n+a),e.stroke(),e.closePath()},n.getColorByDelta=function(e){return e>.2?"#FF0000":e>.1?"#FFFF00":"#00FF00"},n.canvas=i.a.createRef(),n}return Object(k.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.onResize),this.onResize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"componentDidUpdate",value:function(){this.draw()}},{key:"render",value:function(){return i.a.createElement("div",{className:A.a.base},i.a.createElement("canvas",{ref:this.canvas}))}}]),t}(i.a.Component),P=n(14),U=n.n(P),L=function(e){var t=i.a.useState(e.value),n=Object(p.a)(t,2),a=n[0],r=n[1],c=function(t){var n=Math.max(Math.min(t,500),10);r(n),e.onChanged(n)},s=function(e){c(parseInt(e.target.value))};return i.a.createElement("div",{className:U.a.base},i.a.createElement("div",{className:U.a.button,onClick:c.bind(null,a-10)},"-10"),i.a.createElement("div",{className:U.a.button,onClick:c.bind(null,a-5)},"-5"),i.a.createElement("div",{className:U.a.button,onClick:c.bind(null,a-1)},"-1"),i.a.createElement("input",{className:U.a.value,min:10,max:500,type:"number",onChange:s,onBlur:s,onWheel:function(e){c(a+(e.deltaY>0?-1:1))},value:a}),i.a.createElement("div",{className:U.a.button,onClick:c.bind(null,a+1)},"+1"),i.a.createElement("div",{className:U.a.button,onClick:c.bind(null,a+5)},"+5"),i.a.createElement("div",{className:U.a.button,onClick:c.bind(null,a+10)},"+10"))},H=function(){function e(){Object(g.a)(this,e),this.allowKeys=[],this.anyKey=!1,this.startTime=0}return Object(E.a)(e,[{key:"setStartTime",value:function(e){this.startTime=e}},{key:"beforeRun",value:function(){return Promise.resolve()}},{key:"run",value:function(){return Promise.resolve()}},{key:"afterRun",value:function(){return Promise.resolve()}},{key:"onKeyboardEvent",value:function(e,t){}},{key:"onMouseEvent",value:function(e){}}]),e}(),Q=function(){function e(){Object(g.a)(this,e),this.handlers=void 0,this.startTime=0,this.endTime=0,this.inProgress=!1,this.handlers=[]}return Object(E.a)(e,[{key:"addHandler",value:function(e){return this.handlers.push(e),this}},{key:"start",value:function(){var e=this;return v.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return this.inProgress=!0,this.startTime=(new Date).getTime(),Promise.all(this.handlers.map((function(t){return t.setStartTime(e.startTime)}))),t.next=5,v.a.awrap(Promise.all(this.handlers.map((function(e){return e.beforeRun()}))));case 5:return t.next=7,v.a.awrap(Promise.all(this.handlers.map((function(e){return e.run()}))));case 7:return t.next=9,v.a.awrap(Promise.all(this.handlers.map((function(e){return e.afterRun()}))));case 9:case"end":return t.stop()}}),null,this)}}]),e}(),W=function(e){function t(e,n){var a;return Object(g.a)(this,t),(a=Object(_.a)(this,Object(N.a)(t).call(this))).context=void 0,a.gain=void 0,a.oscillator=void 0,a.clicks=void 0,a.preClicksCount=void 0,a.clicks=e,a.preClicksCount=n,a.context=new AudioContext,a.oscillator=a.context.createOscillator(),a.oscillator.type="sine",a.oscillator.frequency.value=1e3,a.gain=a.context.createGain(),a.gain.gain.value=0,a.gain.connect(a.context.destination),a.oscillator.connect(a.gain),a}return Object(k.a)(t,e),Object(E.a)(t,[{key:"beforeRun",value:function(){var e=this;return 0===this.clicks.length?Promise.resolve():(this.clicks.forEach((function(t){e.gain.gain.cancelScheduledValues(t),e.gain.gain.setValueAtTime(0,t),e.gain.gain.linearRampToValueAtTime(1,t+.001),e.gain.gain.linearRampToValueAtTime(0,t+.001+.01)})),this.oscillator.start(0),new Promise((function(t){return setTimeout(t,1e3*e.clicks[e.preClicksCount-1])})))}},{key:"run",value:function(){var e=this,t=this.clicks[this.preClicksCount-1];return new Promise((function(n){return setTimeout(n,1e3*(e.clicks[e.clicks.length-1]-t)+300)}))}}]),t}(H),z=function(e){function t(e,n){var a;return Object(g.a)(this,t),(a=Object(_.a)(this,Object(N.a)(t).call(this))).callback=void 0,a.clicks=void 0,a.clicks=e,a.callback=n,a}return Object(k.a)(t,e),Object(E.a)(t,[{key:"beforeRun",value:function(){var e=this;return this.clicks.length>0&&this.clicks.forEach((function(t,n){return setTimeout((function(){return e.callback(t,n)}),1e3*t)})),Promise.resolve()}}]),t}(H),K=function(e){function t(e,n){var a;return Object(g.a)(this,t),(a=Object(_.a)(this,Object(N.a)(t).call(this,(function(e){a.userClicks.push((e-a.startTime)/1e3),n(a.getUserClicks())})))).clicks=void 0,a.userClicks=void 0,a.getUserClicks=function(){var e=[];return a.userClicks.forEach((function(t){var n=a.clicks.reduce((function(e,n){return Math.abs(e)>Math.abs(n-t)?n-t:e}),1/0);e.push({desiredClick:t+n,actualClick:t,delta:n})})),e},a.clicks=e,a.userClicks=[],a}return Object(k.a)(t,e),t}(function(e){function t(e){var n;return Object(g.a)(this,t),(n=Object(_.a)(this,Object(N.a)(t).call(this))).anyKey=!0,n.callback=void 0,n.handleKeydown=function(e){var t=(new Date).getTime();(n.anyKey||n.allowKeys.includes(e.key))&&n.onKeyboardEvent(t,e.key)},n.handleMouseDown=function(){var e=(new Date).getTime();n.onMouseEvent(e)},n.callback=e,n}return Object(k.a)(t,e),Object(E.a)(t,[{key:"run",value:function(){return document.addEventListener("keydown",this.handleKeydown),document.addEventListener("mousedown",this.handleMouseDown),Promise.resolve()}},{key:"afterRun",value:function(){return document.removeEventListener("keydown",this.handleKeydown),document.removeEventListener("mousedown",this.handleMouseDown),Promise.resolve()}},{key:"onKeyboardEvent",value:function(e,t){this.callback(e-50)}},{key:"onMouseEvent",value:function(e){this.callback(e-50)}}]),t}(H)),G=(w={},Object(O.a)(w,r.Fours,Array.apply(0,Array(4)).map((function(e,t){return t/4}))),Object(O.a)(w,r.Eights,Array.apply(0,Array(8)).map((function(e,t){return t/8}))),Object(O.a)(w,r.Triplets,Array.apply(0,Array(12)).map((function(e,t){return t/12}))),Object(O.a)(w,r.Sixteens,Array.apply(0,Array(16)).map((function(e,t){return t/16}))),w);function B(e,t){var n=240/t,a=[];return e.forEach((function(e,t){a=[].concat(Object(b.a)(a),Object(b.a)(G[e].map((function(e){return n*(e+1*t)}))))})),a}function V(e){var t=[];return e.forEach((function(e,n){G[e].forEach((function(){t.push(n)}))})),t}var J,X=n(3),Y=n.n(X);!function(e){e[e.NOT_STARTED=0]="NOT_STARTED",e[e.COUNTDOWN=1]="COUNTDOWN",e[e.RUNNING=2]="RUNNING",e[e.FINISHED=3]="FINISHED",e[e.FAILED_TO_START=4]="FAILED_TO_START"}(J||(J={}));var Z={changingMetronome:function(){var e=parseInt(localStorage.getItem("saved_bpm")||"60",10),t=i.a.useState([]),n=Object(p.a)(t,2),a=n[0],c=n[1],s=i.a.useState([]),o=Object(p.a)(s,2),l=o[0],u=o[1],m=i.a.useState([]),d=Object(p.a)(m,2),f=d[0],g=d[1],E=i.a.useState(e),_=Object(p.a)(E,2),N=_[0],k=_[1],O=i.a.useState(0),y=Object(p.a)(O,2),j=y[0],T=y[1],S=i.a.useState(J.NOT_STARTED),C=Object(p.a)(S,2),x=C[0],D=C[1],I=i.a.useState(0),w=Object(p.a)(I,2),q=w[0],F=w[1],A=i.a.createRef(),P=function(e){c(e)},U=function(e,t){F(t-4),t<4&&T(t+1),3===t&&D(J.RUNNING)};return i.a.createElement("div",{className:Y.a.base},i.a.createElement("div",{key:q,className:Y.a.blink}),i.a.createElement("div",{className:Y.a.notes},i.a.createElement(R,{isPlaying:x===J.COUNTDOWN||x===J.RUNNING,noteIndex:f[q],playingIndex:q,ref:A,sequence:[r.Fours,r.Eights,r.Triplets,r.Sixteens]})),i.a.createElement("div",{className:Y.a.bpm},i.a.createElement("div",{className:Y.a.caption},"BPM"),i.a.createElement(L,{onChanged:k,value:N})),i.a.createElement("div",{className:Y.a.action},x===J.NOT_STARTED&&i.a.createElement("div",{className:Y.a.info},"Manage sequence, choose bpm and click start"),x===J.COUNTDOWN&&i.a.createElement("div",{className:Y.a.info},j),(x===J.RUNNING||x===J.COUNTDOWN)&&i.a.createElement("div",{className:Y.a.info},"Use any keyboard or mouse button to click"),(x===J.RUNNING||x===J.FINISHED)&&i.a.createElement("div",{className:Y.a.ticks},i.a.createElement(M,{idealClicks:l,realClicks:a,from:4})),x===J.FINISHED&&0!==a.length&&i.a.createElement("div",{className:Y.a.info},"Missed notes:",i.a.createElement("span",{className:Y.a.score},Math.max(l.length-h()(a,(function(e){return e.desiredClick})).length-4,0)),"Average delta:",i.a.createElement("span",{className:Y.a.score},Math.round(1e3*a.map((function(e){return Math.abs(e.delta)})).reduce((function(e,t){return e+t}))/a.length)/1e3)),x===J.FINISHED&&0===a.length&&i.a.createElement("div",{className:Y.a.info},"No results"),(x===J.NOT_STARTED||x===J.FINISHED||x===J.FAILED_TO_START)&&i.a.createElement("button",{className:Y.a.start,onClick:function(){var e,t,n;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(x!==J.COUNTDOWN&&x!==J.RUNNING){a.next=2;break}return a.abrupt("return");case 2:if(A.current){a.next=4;break}return a.abrupt("return");case 4:if(localStorage.setItem("saved_bpm",N.toString()),0!==(e=A.current.state.sequence).length){a.next=9;break}return D(J.FAILED_TO_START),a.abrupt("return");case 9:return t=B([r.Fours].concat(Object(b.a)(e)),N),g(V(e)),c([]),D(J.COUNTDOWN),u(t),(n=new Q).addHandler(new W(t,4)),n.addHandler(new z(t,U)),n.addHandler(new K(t,P)),a.next=20,v.a.awrap(n.start());case 20:D(J.FINISHED);case 21:case"end":return a.stop()}}))}},"START")))}},$=function(){var e=i.a.useContext(l);return i.a.createElement("div",{className:m.a.base},e.map((function(e){return i.a.createElement(i.a.Fragment,{key:e},Z[e]({}))})))},ee=n(90),te=n.n(ee),ne=function(){return i.a.createElement("div",{className:te.a.app},i.a.createElement(l.Provider,{value:Object.keys(Z)},i.a.createElement($,null)))};o.a.render(i.a.createElement(ne,null),document.getElementById("root"))},3:function(e,t,n){e.exports={base:"ChangingMetronomeExercise_base__mA16-",notes:"ChangingMetronomeExercise_notes__3tSdn",bpm:"ChangingMetronomeExercise_bpm__hSsuq",caption:"ChangingMetronomeExercise_caption__2XzOf",action:"ChangingMetronomeExercise_action__6rQqP",info:"ChangingMetronomeExercise_info__3Pb-I",score:"ChangingMetronomeExercise_score__2Qrsv",start:"ChangingMetronomeExercise_start__2_aoc",blink:"ChangingMetronomeExercise_blink__3rmbV",ticks:"ChangingMetronomeExercise_ticks__2XP0a"}},83:function(e,t,n){e.exports={base:"ExerciseList_base__1ctVW"}},89:function(e,t,n){e.exports={base:"UserClicksCanvas_base__2aL8w"}},90:function(e,t,n){e.exports={app:"App_app__3mQin"}},91:function(e,t,n){e.exports=n(226)},96:function(e,t,n){}},[[91,1,2]]]);
//# sourceMappingURL=main.af51ba09.chunk.js.map